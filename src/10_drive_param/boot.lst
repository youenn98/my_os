     1                                  ;**************************
     2                                  ; ÂÆèËÆæÂÆö
     3                                  ;*************************
     4                                  %include "../include/macro.s"
     1                              <1> %macro cdecl 1-*.nolist  ;//1-* «“ª∏ˆ“‘…œµƒ≤Œ ˝
     2                              <1> 
     3                              <1> 	%rep %0 - 1         ;//%0 «≤Œ ˝µƒ∏ˆ ˝
     4                              <1> 		push %{-1:-1}  ;//%Ω´≤Œ ˝µπ◊≈—π’ª
     5                              <1> 		%rotate -1   
     6                              <1> 	%endrep
     7                              <1> 	%rotate -1      ;//ª÷∏¥‘≠¿¥µƒ≤Œ ˝
     8                              <1> 
     9                              <1> 	call %1
    10                              <1> 	%if 1 < %0
    11                              <1> 		add sp,(__BITS__ >> 3)*(%0 - 1)     ;//__BITS__ «±Ì æ16±»Ãÿƒ£ Ωªπ «32±»Ãÿƒ£ Ω
    12                              <1> 	%endif									;//∏¯√ø∏ˆ≤Œ ˝∑÷≈‰’ªø’º‰
    13                              <1> %endmacro
    14                              <1> 
    15                              <1> struc drive
    16 00000000 <res 00000002>      <1> 	.no resw 1	 ;«˝∂Ø∫≈
    17 00000002 <res 00000002>      <1> 	.cyln resw 1 ;cylinder
    18 00000004 <res 00000002>      <1> 	.head resw 1 ;head
    19 00000006 <res 00000002>      <1> 	.sect resw 1 ;sector
    20                              <1> endstruc
    21                              <1> 
     5                                  %include "../include/define.s"
     1                              <1> BOOT_LOAD equ 0x7C00      ;//boot≥Ã–Úº”‘ÿµÿ÷∑
     2                              <1> BOOT_SIZE equ (1024 * 8)  ;//boot¥˙¬Î∂Œ¥Û–°
     3                              <1> SECT_SIZE equ (512)       ;//sector¥Û–°
     4                              <1> BOOT_SECT equ (BOOT_SIZE/SECT_SIZE)   ;//bootµƒsector ˝
     5                              <1> 
     6                                  
     7                                  ORG BOOT_LOAD               ;ÂêëÁºñËØëÂô®ÊåáÁ§∫Âä†ËΩΩÂú∞ÂùÄ
     8                                  
     9                                  entry:
    10 00000000 EB58                    	jmp ipl
    11                                  	;------------------
    12                                  	;BPB(BIOS Parameter Block)
    13                                  	;------------------
    14 00000002 90<rept>                	times 90 -($-$$) db 0x90
    15                                  
    16                                  	;----------------------------
    17                                  	;IPL(Initial Pragram Loader)
    18                                  	;----------------
    19                                  ipl:
    20 0000005A FA                      	cli ;//Á¶ÅÊ≠¢‰∏≠Êñ≠
    21                                  
    22 0000005B B80000                  	mov ax,0x0000
    23 0000005E 8ED8                    	mov ds , ax        ;//Â∞ÜÊÆµÂØÑÂ≠òÂô®ÈÉΩÂÖàËÆæÁΩÆ‰∏∫0
    24 00000060 8EC0                    	mov es , ax
    25 00000062 8ED0                    	mov ss , ax
    26 00000064 BC007C                  	mov sp , BOOT_LOAD   ;//Â∞ÜÊ†àÂ∫ïËÆæÁΩÆ‰∏∫bootÁ®ãÂ∫èÂºÄÂßãÁöÑÂú∞Êñπ
    27                                  
    28 00000067 FB                      	sti ;//ÂÖÅËÆ∏‰∏≠Êñ≠
    29                                  
    30 00000068 8816[B800]              	mov [BOOT + drive.no], dl;//dlÊòØ‰øùÂ≠òÂêØÂä®Á®ãÂ∫èÁöÑÂ§ñÈÉ®ËÆæÂ§áÁöÑÂ∫èÂè∑
    31                                  
    32 0000006C 68[9900]E84E0083C4-     	cdecl puts,.s0
    32 00000074 02                 
    33                                  
    34                                  	;-------------------
    35                                  	;ËØªÂèñÊé•‰∏ãÊù•ÊâÄÊúâÁöÑsector
    36                                  	;-------------------
    37                                  	
    38 00000075 BB0F00                  	mov bx,BOOT_SECT-1
    39 00000078 B9007E                  	mov cx,BOOT_LOAD + SECT_SIZE
    40                                  
    41 0000007B 515368[B800]E89B00-     	cdecl read_chs,BOOT,bx,cx   ;AX = read_chs(.chs,bx,cx)
    41 00000083 83C406             
    42                                  
    43 00000086 39D8                    	cmp ax,bx    ;//if(AX != Ââ©‰∏ãÁöÑsectorÊï∞)
    44 00000088 740C                    .10Q: jz .10E
    45 0000008A 68[A600]E8300083C4-     .10T: cdecl puts, .e0 ;//ÂèëÁîüÈîôËØØ
    45 00000092 02                 
    46 00000093 E84900                  	call reboot      ;//ÈáçÂêØ
    47                                  
    48                                  .10E:
    49 00000096 E92802                  	jmp stage_2    ;//ÂêØÂä®Á®ãÂ∫èÁ¨¨‰∫å‰ΩçÁΩÆ
    50                                  
    51 00000099 426F6F74696E672E2E-     .s0 db "Booting...",0x0A,0x0D,0 ;//0x0AÊòØ‰∏ã‰∏ÄË°å,0x0DÊòØÂ∞ÜkernelÁßªÂà∞ÊúÄÂ∑¶Á´Ø,0‰ª£Ë°®Â≠óÁ¨¶‰∏≤ÁöÑÁªàÁªì
    51 000000A2 2E0A0D00           
    52 000000A6 4572726F723A736563-     .e0 db "Error:sector read",0 ;//ÈîôËØØ‰ø°ÊÅØ
    52 000000AF 746F72207265616400 
    53                                  
    54                                  ;*******************
    55                                  ;ÂêØÂä®È©±Âä®‰ø°ÊÅØ
    56                                  ;*******************
    57                                  ALIGN 2, db 0
    58                                  BOOT:
    59                                  	istruc drive
    60 000000B8 0000                    		at drive.no, dw 0
    61 000000BA 0000                    		at drive.cyln, dw 0
    62 000000BC 0000                    		at drive.head, dw 0
    63 000000BE 0200                    		at drive.sect, dw 2
    64                                  	iend
    65                                  
    66                                  ;**********************
    67                                  ;module
    68                                  ;***********************
    69                                  %include "../modules/real/puts.s"
     1                              <1> puts:
     2 000000C0 55                  <1> 	push bp
     3 000000C1 89E5                <1> 	mov bp,sp
     4                              <1> 
     5 000000C3 50                  <1> 	push ax
     6 000000C4 53                  <1> 	push bx
     7 000000C5 56                  <1> 	push si
     8                              <1> 
     9                              <1> 	;**************
    10                              <1> 	;»°µ√◊÷∑˚¥Æµƒø™ ºµÿ÷∑
    11                              <1> 	;**************
    12 000000C6 8B7604              <1> 	mov si,[bp+4]
    13                              <1> 
    14 000000C9 B40E                <1> 	mov ah,0x0E
    15 000000CB BB0000              <1> 	mov bx,0x0000
    16 000000CE FC                  <1> 	cld    ;//DF = 0 µÿ÷∑µ›‘ˆ
    17                              <1> 
    18                              <1> .10L:
    19                              <1> 	
    20 000000CF AC                  <1> 	lodsb ;//AL = *SI++
    21                              <1> 
    22 000000D0 3C00                <1> 	cmp al,0	;//if(AL == 0)
    23 000000D2 7404                <1> 	je	.10E	;//breal
    24                              <1> 
    25 000000D4 CD10                <1> 	int 0x10
    26 000000D6 EBF7                <1> 	jmp .10L
    27                              <1> .10E:
    28                              <1> 
    29 000000D8 5E                  <1> 	pop si
    30 000000D9 5B                  <1> 	pop bx
    31 000000DA 58                  <1> 	pop ax
    32                              <1> 
    33 000000DB 89EC                <1> 	mov sp,bp
    34 000000DD 5D                  <1> 	pop bp
    35                              <1> 
    36 000000DE C3                  <1> 	ret
    70                                  %include "../modules/real/reboot.s"
     1                              <1> reboot:
     2                              <1> 	;---------------------
     3                              <1> 	;±Ì æ÷ÿ∆Ù–≈œ¢
     4                              <1> 	;--------------------
     5 000000DF 68[FB00]E8DBFF83C4- <1> 	cdecl puts, .s0
     5 000000E7 02                  <1>
     6                              <1> 
     7                              <1> 	;-----------------
     8                              <1> 	;µ»¥˝ ‰»Î
     9                              <1> 	;-----------------
    10                              <1> 
    11                              <1> .10L:
    12                              <1> 	
    13 000000E8 B410                <1> 	mov ah,0x10
    14 000000EA CD16                <1> 	int 0x16
    15                              <1> 
    16 000000EC 3C00                <1> 	cmp al,''  ;//»Áπ˚ª∫≥Â«¯”– ˝æ›,µ»¥˝”√ªß ‰»Îªÿ≥µ
    17 000000EE 75F8                <1> 	jne .10L  
    18                              <1> 
    19                              <1> 	;------------------------------
    20                              <1> 	;ªª––
    21                              <1> 	;-----------------------------
    22                              <1> 
    23 000000F0 68[1901]E8CAFF83C4- <1> 	cdecl puts, .s1
    23 000000F8 02                  <1>
    24                              <1> 
    25 000000F9 CD19                <1> 	int 0x19 ;//÷ÿ∆Ù
    26                              <1> 
    27 000000FB 0A0D50555348205350- <1> .s0 db 0x0A,0x0D,"PUSH SPACE key to reboot...",0x0A
    27 00000104 414345206B65792074- <1>
    27 0000010D 6F207265626F6F742E- <1>
    27 00000116 2E2E0A              <1>
    28 00000119 0A0D0A0D00          <1> .s1 db 0x0A,0x0D,0x0A,0x0D,0
    71                                  %include "../modules/real/read_chs.s"
     1                              <1> read_chs:	
     2                              <1> 			; +8 ∏¥÷∆µƒƒøµƒµÿ
     3                              <1> 			; +6 sector ˝
     4                              <1> 			; +4 parameter  buffer
     5 0000011E 55                  <1> 	push bp
     6 0000011F 89E5                <1> 	mov bp,sp
     7 00000121 6A03                <1> 	push 3 ;//÷ÿ ‘µƒ¥Œ ˝
     8 00000123 6A00                <1> 	push 0 ;//∂¡»Îµƒsector ˝
     9                              <1> 
    10 00000125 53                  <1> 	push bx
    11 00000126 51                  <1> 	push cx
    12 00000127 52                  <1> 	push dx
    13 00000128 06                  <1> 	push es
    14 00000129 56                  <1> 	push si
    15                              <1> 
    16 0000012A 8B7604              <1> 	mov si,[bp+4]    ;SI = SRCª∫¥Ê
    17                              <1> 
    18                              <1> 	;------------------
    19                              <1> 	;CXºƒ¥Ê∆˜µƒ…Ë∂®
    20                              <1> 	;------------------
    21 0000012D 8A6C02              <1> 	mov ch,[si + drive.cyln+0]  ;//ch = cylinder∫≈
    22 00000130 8A4C03              <1> 	mov cl,[si + drive.cyln+1]  ;//cl = cylinder∫≈
    23 00000133 C0E106              <1> 	shl cl,6 ;// ch << 6  ˝æ›œÚ◊Ó∏ﬂŒª∂‘∆Î(cylinder∫≈10Œª)
    24 00000136 0A4C06              <1> 	or cl,[si + drive.sect]    ;//Ω´6Œªµƒsector∫≈…Ë÷√µΩcxºƒ¥Ê∆˜µƒµÕ¡˘Œª
    25                              <1> 
    26                              <1> 	;--------------------
    27                              <1> 	;∂¡»°sector
    28                              <1> 	;---------------------
    29 00000139 8A7404              <1> 	mov dh,[si + drive.head] ;//head∫≈
    30 0000013C 8A14                <1> 	mov dl,[si+0];         ;//«˝∂Ø∫≈
    31 0000013E B80000              <1> 	mov ax,0x0000        
    32 00000141 8EC0                <1> 	mov es,ax
    33 00000143 8B5E08              <1> 	mov bx,[bp+8]      ;//∏¥÷∆µƒƒøµƒµÿ
    34                              <1> .10L:
    35                              <1> 	
    36 00000146 B402                <1> 	mov ah,0x02     ;//∂¡»°sectorµƒ√¸¡Ó
    37 00000148 8A4606              <1> 	mov al,[bp+6] ;//sector ˝
    38                              <1> 
    39 0000014B CD13                <1> 	int 0X13
    40 0000014D 7304                <1> 	jnc .11E		;//»Áπ˚CF±ª…Ë÷√¡À
    41 0000014F B000                <1> 	mov al,0		;//al = 0
    42 00000151 EB0C                <1> 	jmp .10E
    43                              <1> 
    44                              <1> .11E:
    45                              <1> 
    46 00000153 3C00                <1> 	cmp al,0		
    47 00000155 7508                <1> 	jne .10E  ;//»Áπ˚”–∂¡µΩsector,‘Ú’˝≥£‘À––,∑Ò◊ﬂ÷ÿ ‘
    48                              <1> 
    49 00000157 B80000              <1> 	mov ax,0
    50 0000015A FF4EFE              <1> 	dec word[bp-2]
    51 0000015D 75E7                <1> 	jnz .10L
    52                              <1> .10E:
    53 0000015F B400                <1> 	mov ah,0
    54                              <1> 
    55 00000161 5E                  <1> 	pop si
    56 00000162 07                  <1> 	pop es
    57 00000163 5A                  <1> 	pop dx
    58 00000164 59                  <1> 	pop cx
    59 00000165 5B                  <1> 	pop bx
    60                              <1> 
    61 00000166 89EC                <1> 	mov sp,bp
    62 00000168 5D                  <1> 	pop bp
    63 00000169 C3                  <1> 	ret
    64                              <1> 
    65                              <1> 
    66                              <1> 
    67                              <1> 
    68                              <1> 
    69                              <1> 
    70                              <1> 
    72                                  ;******************
    73                                  ;boot_flag
    74                                  ;*******************
    75 0000016A 00<rept>                	times 510 -($-$$) db 0x00
    76 000001FE 55AA                    	db 0x55,0xAA
    77                                  
    78                                  ;*********************
    79                                  ;bootÂ§ÑÁêÜÁöÑÁ¨¨‰∫åÈò∂ÊÆµ
    80                                  ;*********************
    81                                  
    82                                  ;********************
    83                                  ;modules
    84                                  ;********************
    85                                  %include "..\modules\real\itoa.s"
     1                              <1> itoa:
     2                              <1> 		;	+12|∑˚∫≈
     3                              <1> 		;	+10|ª˘ ˝
     4                              <1> 		;	+8 |ª∫¥Êµƒ¥Û–°
     5                              <1> 		;	+6 |ª∫¥Êµƒµÿ÷∑
     6                              <1> 		;	+4 | ˝÷µ
     7                              <1> 		;	+2 |IP (∑µªÿµÿ÷∑)
     8                              <1> 		; BP+0 | ‘≠¿¥µƒBP
     9                              <1> 
    10 00000200 55                  <1> 	push bp
    11 00000201 89E5                <1> 	mov bp,sp
    12                              <1> 
    13 00000203 50                  <1> 	push ax
    14 00000204 53                  <1> 	push bx
    15 00000205 51                  <1> 	push cx
    16 00000206 52                  <1> 	push dx
    17 00000207 56                  <1> 	push si
    18 00000208 57                  <1> 	push di
    19                              <1> 
    20                              <1> 
    21 00000209 8B4604              <1> 	mov ax,[bp + 4] ;//ax =  ˝÷µ
    22 0000020C 8B7606              <1> 	mov si,[bp + 6] ;//si = ª∫¥Êµÿ÷∑
    23 0000020F 8B4E08              <1> 	mov cx,[bp + 8] ;//cx = ª∫¥Êµÿ÷∑»›¡ø
    24 00000212 89F7                <1> 	mov di , si	  ;//di = ª∫¥Êµƒ◊Ó∫Û
    25 00000214 01CF                <1> 	add di , cx
    26 00000216 4F                  <1> 	dec di
    27                              <1> 
    28 00000217 8B5E0C              <1> 	mov bx,word[bp+12] ;//bx = flag
    29                              <1> 
    30                              <1> 	;--------------
    31                              <1> 	;≈–∂œ «∑Ò «”–∑˚∫≈ ˝
    32                              <1> 	;--------------
    33 0000021A F7C30100            <1> 	test bx,0b0001   ;//(bx&0x01) »Áπ˚◊Ó∫Û“ªŒª «1,Àµ√˜ «¥¯∑˚∫≈µƒ
    34 0000021E 7408                <1> .10Q: je .10E       
    35 00000220 83F800              <1> 	 cmp ax,0        ;//»Áπ˚ ax < 0
    36 00000223 7D03                <1> .12Q: jge  .12E
    37 00000225 83CB02              <1> 	or   bx,0b0010  ;//±Ì æ∑˚∫≈
    38                              <1> .12E:
    39                              <1> .10E:
    40                              <1> 
    41                              <1> 
    42                              <1> 	;-------------------
    43                              <1> 	;≈–∂® ‰≥ˆ ≤√¥∑˚∫≈
    44                              <1> 	;--------------------
    45 00000228 F7C30200            <1> 	test bx,0b0010 ;//(bx&0x02) »Áπ˚ «≤ª «0,‘ÚÀµ√˜–Ë“™…Ë÷√∑˚∫≈
    46 0000022C 7410                <1> .20Q: je .20E
    47 0000022E 83F800              <1> 	 cmp ax,0
    48 00000231 7D07                <1> .22Q: jge .22F
    49 00000233 F7D8                <1> 	neg ax
    50 00000235 C6042D              <1> 	mov [si],byte'-'
    51 00000238 EB03                <1> 	jmp .22E
    52                              <1> .22F:
    53                              <1> 
    54 0000023A C6042B              <1> 	mov  [si],byte'+'
    55                              <1> .22E:
    56 0000023D 49                  <1> 	dec cx   ;//size--
    57                              <1> 
    58                              <1> .20E:
    59                              <1> 
    60                              <1> 	;---------------------
    61                              <1> 	;ASCII±‰ªª
    62                              <1> 	;--------------------
    63 0000023E 8B5E0A              <1> 	mov bx,[bp+10] ;//BX = ª˘ ˝
    64                              <1> .30L:
    65                              <1> 	
    66 00000241 BA0000              <1> 	mov dx,0
    67 00000244 F7F3                <1> 	div bx      ;//dx = AX%ª˘ ˝
    68                              <1> 				;//ax = AX/ª˘ ˝
    69 00000246 89D6                <1> 	mov si,dx
    70 00000248 8A94[7002]          <1> 	mov dl,byte[.ascii+si] ;//dl = ASCII[DX]
    71                              <1> 
    72 0000024C 8815                <1> 	mov [di],dl  ;//*dst = dl
    73                              <1> 
    74 0000024E 4F                  <1> 	dec di		; dst--;
    75                              <1> 
    76 0000024F 83F800              <1> 	cmp ax,0             ;
    77 00000252 E0ED                <1> 	loopnz .30L   ;//while(ax)
    78                              <1> .30E:
    79                              <1> 	
    80                              <1> 	;-------------------
    81                              <1> 	;ÃÓ¬˙ªªª∫¥Ê £”‡ø’∏Ò
    82                              <1> 	;-------------------
    83                              <1> 
    84 00000254 83F900              <1> 	cmp cx,0  ;//»Áπ˚√ª”–ª∫¥Ê £”‡‘ÚÕÍ≥…
    85 00000257 740D                <1> .40Q: je   .40E
    86 00000259 B020                <1> 	  mov  al,' ' ;//ø’◊÷∑˚ÃÓ≥‰
    87 0000025B 837E0C04            <1> 	  cmp [bp+12],word 0b0100 
    88 0000025F 7502                <1> .42Q jne .42E
    89 00000261 B030                <1> 	 mov al,'0'  ;// ”√0ÃÓ≥‰
    90                              <1> .42E:
    91 00000263 FD                  <1> 	std       ;//DF = 1 (µÿ÷∑µ›ºı)
    92 00000264 F3AA                <1> 	rep stosb    ;//while(--CX) *DI-- = al;
    93                              <1> .40E:
    94                              <1> 
    95 00000266 5F                  <1> 	pop di
    96 00000267 5E                  <1> 	pop si
    97 00000268 5A                  <1> 	pop dx
    98 00000269 59                  <1> 	pop cx
    99 0000026A 5B                  <1> 	pop bx
   100 0000026B 58                  <1> 	pop ax
   101                              <1> 
   102 0000026C 89EC                <1> 	mov sp,bp
   103 0000026E 5D                  <1> 	pop bp
   104                              <1> 
   105 0000026F C3                  <1> 	ret
   106                              <1> 
   107 00000270 303132333435363738- <1> .ascii db "0123456789ABCDEF"
   107 00000279 39414243444546      <1>
    86                                  %include "..\modules\real\get_drive_param.s"
     1                              <1> get_drive_param:
     2                              <1> 	
     3                              <1> 
     4                              <1> 
     5 00000280 55                  <1> 	push bp
     6 00000281 89E5                <1> 	mov bp,sp
     7                              <1> 
     8                              <1> 
     9 00000283 53                  <1> 	push bx
    10 00000284 51                  <1> 	push cx
    11 00000285 06                  <1> 	push es
    12 00000286 56                  <1> 	push si
    13 00000287 57                  <1> 	push di
    14                              <1> 
    15                              <1> 
    16                              <1> 
    17 00000288 8B7604              <1> 	mov si,[bp+4]
    18                              <1> 
    19 0000028B B80000              <1> 	mov ax,0   ;//Disk Base Table Pointer§Œ≥ı∆⁄ªØ
    20 0000028E 8EC0                <1> 	mov es,ax
    21 00000290 89C7                <1> 	mov di,ax  
    22                              <1> 
    23 00000292 B408                <1> 	mov ah,8 ;//»°µ√drive parameters
    24 00000294 8A14                <1> 	mov dl,[si+drive.no] ;//dl = drive∫≈
    25 00000296 CD13                <1> 	int 0x13
    26 00000298 721B                <1> .10Q: jc   .10F
    27                              <1> .10T:
    28 0000029A 88C8                <1> 	mov al,cl
    29 0000029C 83E03F              <1> 	and ax,0x3F ;//◊ÓµÕ¡˘Œª
    30                              <1> 
    31 0000029F C0E906              <1> 	shr  cl,6;    CX = cylinder ˝
    32 000002A2 C1C908              <1> 	ror cx,8;	
    33 000002A5 41                  <1> 	inc cx ;	cylinder¥”1º∆ ˝
    34                              <1> 
    35 000002A6 0FB6DE              <1> 	movzx bx,dh     ;bx = head ˝
    36 000002A9 43                  <1> 	inc bx			
    37                              <1> 
    38 000002AA 894C02              <1> 	mov  [si+drive.cyln],cx
    39 000002AD 895C04              <1> 	mov  [si+drive.head],bx
    40 000002B0 894406              <1> 	mov  [si+drive.sect],ax
    41                              <1> 
    42 000002B3 EB03                <1> 	jmp .10E
    43                              <1> .10F:
    44 000002B5 B80000              <1> 	mov ax,0
    45                              <1> .10E:
    46 000002B8 5F                  <1> 	pop di
    47 000002B9 5E                  <1> 	pop si
    48 000002BA 07                  <1> 	pop es
    49 000002BB 59                  <1> 	pop cx
    50 000002BC 5B                  <1> 	pop bx
    51                              <1> 
    52 000002BD 89EC                <1> 	mov sp,bp
    53 000002BF 5D                  <1> 	pop bp
    54                              <1> 
    55 000002C0 C3                  <1> 	ret
    87                                  
    88                                  
    89                                  stage_2:
    90 000002C1 68[3B03]E8F9FD83C4-     	cdecl puts, .s0
    90 000002C9 02                 
    91                                  
    92                                  	;-----------------
    93                                  	;ÂèñÂæódriveÁöÑ‰ø°ÊÅØ
    94                                  	;---------------;
    95                                  
    96 000002CA 68[B800]E8B0FF83C4-     	cdecl get_drive_param,BOOT ;(get_drive_param(DX,BOOT.CYLN))
    96 000002D2 02                 
    97 000002D3 83F800                  	cmp ax,0
    98 000002D6 750C                    .10Q: jne .10E
    99 000002D8 68[6C03]E8E2FD83C4-     .10T: cdecl puts,.e0
    99 000002E0 02                 
   100 000002E1 E8FBFD                  	call reboot
   101                                  .10E:
   102 000002E4 A1[B800]                	mov ax,[BOOT + drive.no]
   103 000002E7 6A046A106A0268-         	cdecl itoa,ax,.p1,2,16,0b0100
   103 000002EE [5303]50E80CFF83C4-
   103 000002F6 0A                 
   104 000002F7 A1[BA00]                	mov ax,[BOOT + drive.cyln]
   105 000002FA 6A046A106A0268-         	cdecl itoa,ax,.p2,2,16,0b0100
   105 00000301 [5A03]50E8F9FE83C4-
   105 00000309 0A                 
   106 0000030A A1[BC00]                	mov ax,[BOOT + drive.head]
   107 0000030D 6A046A106A0268-         	cdecl itoa,ax,.p3,2,16,0b0100
   107 00000314 [6103]50E8E6FE83C4-
   107 0000031C 0A                 
   108 0000031D A1[BE00]                	mov ax,[BOOT + drive.sect]
   109 00000320 6A046A106A0268-         	cdecl itoa,ax,.p4,2,16,0b0100
   109 00000327 [6803]50E8D3FE83C4-
   109 0000032F 0A                 
   110                                  
   111 00000330 68[4A03]E88AFD83C4-     	cdecl puts, .s1
   111 00000338 02                 
   112                                  
   113 00000339 EBFE                    	jmp $
   114                                  
   115 0000033B 326E64207374616765-     .s0 db "2nd stage...",0X0A,0x0D,0
   115 00000344 2E2E2E0A0D00       
   116                                  
   117 0000034A 2044726976653A3078      .s1 db " Drive:0x"
   118 00000353 202C20433A3078          .p1 db " , C:0x" 
   119 0000035A 202C20483A3078          .p2 db " , H:0x" 
   120 00000361 202C20533A3078          .p3 db " , S:0x" 
   121 00000368 200A0D00                .p4 db " ", 0X0A,0X0D,0 
   122 0000036C 43616E272074206765-     .e0 db "Can' t get drive parameter.", 0
   122 00000375 742064726976652070-
   122 0000037E 6172616D657465722E-
   122 00000387 00                 
   123                                  
   124                                  
   125                                  ;**********************
   126                                  ;padding
   127                                  ;**********************
   128 00000388 00<rept>                	times BOOT_SIZE-($-$$) db 0 ;//8KB
